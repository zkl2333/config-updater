version: '3.8'

services:
  # 示例：Mihomo 服务
  mihomo:
    container_name: mihomo
    image: metacubex/mihomo:Alpha
    restart: always
    ports:
      - '7890:7890'
      - '9090:9090'
    volumes:
      - ./config:/root/.config/mihomo

  # 配置更新服务
  config-updater:
    build: .
    container_name: config-updater
    restart: always
    environment:
      # 必需：订阅地址
      - SUB_URL=https://your-subscription-url

      # 可选：配置文件路径（默认：/config/config.yaml）
      # - CONFIG_PATH=/config/config.yaml

      # 可选：更新间隔秒数（默认：3600）
      # - UPDATE_INTERVAL=3600
    volumes:
      # 挂载目录（程序自动创建配置文件）
      - ./config:/config
      # 可选：Hook 脚本（固定路径）
      # - ./hooks/mihomo.sh:/hooks/post-update:ro
    depends_on:
      - mihomo
